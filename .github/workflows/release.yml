name: Release Pillarbox
on:
  workflow_dispatch:

jobs:
  PublishRelease:
    environment: Production
    name: Build and upload library to Github packages
    uses: SRGSSR/pillarbox-android/.github/workflows/.github/workflows/publish-library.yml@main
    with:
      isSnapshot: false
    secrets: inherit
  UploadDemo:
    needs: PublishRelease
    name: Upload Demo to Firebase AppDistribution
    uses: SRGSSR/pillarbox-android/.github/workflows/.github/workflows/publish-demo.yml@main
    with:
      groups: { { secrets.RELEASE_GROUPS } }
      application-id: { { secrets.RELEASE_APP_ID } }
    secrets: inherit
